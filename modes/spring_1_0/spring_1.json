{
  "name": "SPRING",
  "stages": [
    {
      "name": "purge",
      "nodes": [
        {
          "id": -1,
          "controllers": [],
          "triggers": [
            {
              "kind": "piston_position_trigger",
              "position_reference_id": 0,
              "operator": ">=",
              "value": 60,
              "next_node_id": 5,
              "source": "Piston Position Raw"
            },
            {
              "kind": "piston_position_trigger",
              "position_reference_id": 0,
              "operator": "<",
              "value": 60,
              "next_node_id": 2,
              "source": "Piston Position Raw"
            },
            {
              "kind": "button_trigger",
              "source": "Encoder Button",
              "gesture": "Single Tap",
              "next_node_id": 5
            }
          ]
        },
        {
          "id": 2,
          "controllers": [
            {
              "kind": "move_piston_controller",
              "algorithm": "Piston Ease-In",
              "direction": "DOWN",
              "speed": 6
            },
            {
              "kind": "time_reference",
              "id": 30
            }
          ],
          "triggers": [
            {
              "kind": "pressure_value_trigger",
              "source": "Pressure Raw",
              "operator": ">=",
              "value": 6,
              "next_node_id": 3
            },
            {
              "kind": "piston_position_trigger",
              "position_reference_id": 0,
              "source": "Piston Position Raw",
              "operator": ">=",
              "value": 60,
              "next_node_id": 5
            },
            {
              "kind": "button_trigger",
              "source": "Encoder Button",
              "gesture": "Single Tap",
              "next_node_id": 5
            }
          ]
        },
        {
          "id": 3,
          "controllers": [
            {
              "kind": "pressure_controller",
              "algorithm": "Pressure PID v1.0",
              "curve": {
                "id": 13,
                "interpolation_kind": "linear_interpolation",
                "points": [
                  [
                    0,
                    6
                  ]
                ],
                "reference": {
                  "kind": "time",
                  "id": 30
                }
              }
            }
          ],
          "triggers": [
            {
              "kind": "piston_position_trigger",
              "position_reference_id": 0,
              "source": "Piston Position Raw",
              "operator": ">=",
              "value": 60,
              "next_node_id": 5
            },
            {
              "kind": "button_trigger",
              "source": "Encoder Button",
              "gesture": "Single Tap",
              "next_node_id": 5
            }
          ]
        },
        {
          "id": 5,
          "controllers": [
            {
              "kind": "time_reference",
              "id": 2
            },
            {
              "kind": "move_piston_controller",
              "algorithm": "Piston Ease-In",
              "direction": "DOWN",
              "speed": 0
            }
          ],
          "triggers": [
            {
              "kind": "water_detection_trigger",
              "value": true,
              "next_node_id": 7
            },
            {
              "kind": "water_detection_trigger",
              "value": false,
              "next_node_id": 6
            }
          ]
        },
        {
          "id": 6,
          "controllers": [
            {
              "kind": "log_controller",
              "message": "No Water"
            }
          ],
          "triggers": [
            {
              "kind": "timer_trigger",
              "timer_reference_id": 2,
              "operator": ">=",
              "value": 2,
              "next_node_id": 5
            },
            {
              "kind": "timer_trigger",
              "timer_reference_id": 1,
              "operator": ">=",
              "value": 100,
              "next_node_id": -2
            }
          ]
        }
      ]
    },
    {
      "name": "heating",
      "nodes": [
        {
          "id": 7,
          "controllers": [
            {
              "kind": "temperature_controller",
              "algorithm": "Cylinder Temperature PID v1.0",
              "curve": {
                "id": 0,
                "interpolation_kind": "linear_interpolation",
                "points": [
                  [
                    0,
                    180
                  ]
                ],
                "reference": {
                  "kind": "time",
                  "id": 2
                }
              }
            },
            {
              "kind": "position_reference",
              "id": 5
            },
            {
              "kind": "time_reference",
              "id": 20
            }
          ],
          "triggers": [
            {
              "kind": "temperature_value_trigger",
              "source": "Tube Temperature",
              "operator": ">=",
              "value": 83,
              "next_node_id": 33
            },
            {
              "kind": "timer_trigger",
              "timer_reference_id": 2,
              "operator": ">=",
              "value": 900,
              "next_node_id": -2
            },
            {
              "kind": "button_trigger",
              "source": "Encoder Button",
              "gesture": "Single Tap",
              "next_node_id": 33
            }
          ]
        }
      ]
    },
    {
      "name": "retracting",
      "nodes": [
        {
          "id": 33,
          "controllers": [
            {
              "kind": "move_piston_controller",
              "algorithm": "Piston Ease-In",
              "direction": "UP",
              "speed": 4
            }
          ],
          "triggers": [
            {
              "kind": "piston_position_trigger",
              "position_reference_id": 5,
              "operator": "<=",
              "value": -2,
              "next_node_id": 9,
              "source": "Piston Position Raw"
            }
          ]
        },
        {
          "id": 9,
          "controllers": [
            {
              "kind": "move_piston_controller",
              "algorithm": "Piston Ease-In",
              "direction": "UP",
              "speed": 6
            }
          ],
          "triggers": [
            {
              "kind": "piston_speed_trigger",
              "operator": "==",
              "value": 0,
              "next_node_id": 25
            }
          ]
        },
        {
          "id": 25,
          "controllers": [
            {
              "kind": "tare_controller"
            },
            {
              "kind": "time_reference",
              "id": 10
            }
          ],
          "triggers": [
            {
              "kind": "exit",
              "next_node_id": 26
            }
          ]
        },
        {
          "id": 26,
          "controllers": [
            {
              "kind": "weight_reference",
              "id": 1
            }
          ],
          "triggers": [
            {
              "kind": "timer_trigger",
              "timer_reference_id": 10,
              "operator": ">=",
              "value": 2,
              "next_node_id": 21
            }
          ]
        }
      ]
    },
    {
      "name": "closing valve",
      "nodes": [
        {
          "id": 21,
          "controllers": [
            {
              "kind": "move_piston_controller",
              "algorithm": "Piston Ease-In",
              "direction": "DOWN",
              "speed": 5
            },
            {
              "kind": "time_reference",
              "id": 3
            }
          ],
          "triggers": [
            {
              "kind": "pressure_value_trigger",
              "source": "Pressure Raw",
              "operator": ">=",
              "value": 0.2,
              "next_node_id": 43
            }
          ]
        }
      ]
    },
    {
      "name": "preinfusion",
      "nodes": [
        {
          "id": 43,
          "controllers": [
            {
              "kind": "time_reference",
              "id": 5
            }
          ],
          "triggers": [
            {
              "kind": "exit",
              "next_node_id": 10
            }
          ]
        },
        {
          "id": 10,
          "controllers": [
            {
              "kind": "temperature_controller",
              "algorithm": "Cylinder Temperature PID v1.0",
              "curve": {
                "id": 3,
                "interpolation_kind": "linear_interpolation",
                "points": [
                  [
                    0,
                    25
                  ]
                ],
                "reference": {
                  "kind": "time",
                  "id": 2
                }
              }
            },
            {
              "kind": "flow_controller",
              "algorithm": "Flow PID v1.0",
              "curve": {
                "id": 4,
                "interpolation_kind": "catmull_interpolation",
                "points": [
                  [
                    0,
                    4
                  ]
                ],
                "reference": {
                  "kind": "time",
                  "id": 5
                }
              }
            },
            {
              "kind": "position_reference",
              "id": 1
            }
          ],
          "triggers": [
            {
              "kind": "timer_trigger",
              "timer_reference_id": 5,
              "operator": ">=",
              "value": 50,
              "next_node_id": 38
            },
            {
              "kind": "pressure_value_trigger",
              "source": "Pressure Predictive",
              "operator": ">=",
              "value": 6,
              "next_node_id": 11
            },
            {
              "kind": "weight_value_trigger",
              "source": "Weight Raw",
              "weight_reference_id": 1,
              "operator": ">=",
              "value": 1,
              "next_node_id": 38
            },
            {
              "kind": "button_trigger",
              "source": "Encoder Button",
              "gesture": "Single Tap",
              "next_node_id": 38
            }
          ]
        },
        {
          "id": 11,
          "controllers": [
            {
              "kind": "pressure_controller",
              "algorithm": "Pressure PID v1.0",
              "curve": {
                "id": 6,
                "interpolation_kind": "catmull_interpolation",
                "points": [
                  [
                    0,
                    6
                  ]
                ],
                "reference": {
                  "kind": "time",
                  "id": 5
                }
              }
            },
            {
              "kind": "position_reference",
              "id": 1
            }
          ],
          "triggers": [
            {
              "kind": "timer_trigger",
              "timer_reference_id": 5,
              "operator": ">=",
              "value": 50,
              "next_node_id": 38
            },
            {
              "kind": "flow_curve_trigger",
              "source": "Flow Raw",
              "operator": ">=",
              "curve_id": 4,
              "next_node_id": 10
            },
            {
              "kind": "weight_value_trigger",
              "source": "Weight Raw",
              "weight_reference_id": 1,
              "operator": ">=",
              "value": 1,
              "next_node_id": 38
            },
            {
              "kind": "button_trigger",
              "source": "Encoder Button",
              "gesture": "Single Tap",
              "next_node_id": 38
            }
          ]
        }
      ]
    },
    {
      "name": "spring",
      "nodes": [
        {
          "id": 38,
          "controllers": [
            {
              "kind": "position_reference",
              "id": 8
            },
            {
              "kind": "time_reference",
              "id": 31
            },
            {
              "kind": "weight_reference",
              "id": 3
            }
          ],
          "triggers": [
            {
              "kind": "exit",
              "next_node_id": 39
            }
          ]
        },
        {
          "id": 39,
          "controllers": [
            {
              "kind": "piston_power_controller",
              "algorithm": "Spring v1.0",
              "curve": {
                "id": 16,
                "interpolation_kind": "catmull_interpolation",
                "points": [
                  [
                    0,
                    50
                  ],
                  [
                    60,
                    90
                  ]
                ],
                "reference": {
                  "kind": "position",
                  "id": 8
                }
              }
            }
          ],
          "triggers": [
            {
              "kind": "piston_position_trigger",
              "position_reference_id": 7,
              "operator": ">=",
              "value": 60,
              "next_node_id": 34,
              "source": "Piston Position Raw"
            },
            {
              "kind": "pressure_value_trigger",
              "source": "Pressure Predictive",
              "operator": ">=",
              "value": 11,
              "next_node_id": 41
            },
            {
              "kind": "weight_value_trigger",
              "source": "Weight Raw",
              "weight_reference_id": 1,
              "operator": ">=",
              "value": 45,
              "next_node_id": 34
            },
            {
              "kind": "button_trigger",
              "source": "Encoder Button",
              "gesture": "Single Tap",
              "next_node_id": 34
            }
          ]
        },
        {
          "id": 41,
          "controllers": [
            {
              "kind": "pressure_controller",
              "algorithm": "Pressure PID v1.0",
              "curve": {
                "id": 18,
                "interpolation_kind": "linear_interpolation",
                "points": [
                  [
                    0,
                    11
                  ]
                ],
                "reference": {
                  "kind": "time",
                  "id": 31
                }
              }
            }
          ],
          "triggers": [
            {
              "kind": "piston_power_curve_trigger",
              "source": "Raw Piston Power",
              "operator": ">=",
              "curve_id": 16,
              "next_node_id": 39
            },
            {
              "kind": "piston_position_trigger",
              "position_reference_id": 7,
              "operator": ">=",
              "value": 60,
              "next_node_id": 34,
              "source": "Piston Position Raw"
            },
            {
              "kind": "weight_value_trigger",
              "source": "Weight Raw",
              "weight_reference_id": 1,
              "operator": ">=",
              "value": 45,
              "next_node_id": 34
            },
            {
              "kind": "button_trigger",
              "source": "Encoder Button",
              "gesture": "Single Tap",
              "next_node_id": 34
            }
          ]
        }
      ]
    },
    {
      "name": "idle",
      "nodes": [
        {
          "id": 34,
          "controllers": [
            {
              "kind": "time_reference",
              "id": 25
            }
          ],
          "triggers": [
            {
              "kind": "exit",
              "next_node_id": 35
            }
          ]
        },
        {
          "id": 35,
          "controllers": [],
          "triggers": [
            {
              "kind": "timer_trigger",
              "timer_reference_id": 25,
              "operator": ">=",
              "value": 0.2,
              "next_node_id": 31
            }
          ]
        }
      ]
    },
    {
      "name": "retracting",
      "nodes": [
        {
          "id": 31,
          "controllers": [
            {
              "kind": "weight_reference",
              "id": 2
            },
            {
              "kind": "time_reference",
              "id": 17
            }
          ],
          "triggers": [
            {
              "kind": "exit",
              "next_node_id": 14
            }
          ]
        },
        {
          "id": -2,
          "controllers": [
            {
              "kind": "end_profile"
            }
          ],
          "triggers": []
        },
        {
          "id": 14,
          "controllers": [
            {
              "kind": "move_piston_controller",
              "algorithm": "Piston Fast",
              "direction": "UP",
              "speed": 4
            },
            {
              "kind": "time_reference",
              "id": 18
            }
          ],
          "triggers": [
            {
              "kind": "piston_position_trigger",
              "position_reference_id": 1,
              "operator": "<=",
              "value": -4,
              "next_node_id": 15,
              "source": "Piston Position Raw"
            },
            {
              "kind": "timer_trigger",
              "timer_reference_id": 17,
              "operator": ">=",
              "value": 5,
              "next_node_id": 15
            }
          ]
        },
        {
          "id": 15,
          "controllers": [
            {
              "kind": "move_piston_controller",
              "algorithm": "Piston Fast",
              "direction": "UP",
              "speed": 6
            }
          ],
          "triggers": [
            {
              "kind": "timer_trigger",
              "timer_reference_id": 18,
              "operator": ">=",
              "value": 3,
              "next_node_id": 32
            }
          ]
        },
        {
          "id": 32,
          "controllers": [],
          "triggers": [
            {
              "kind": "piston_speed_trigger",
              "operator": "==",
              "value": 0,
              "next_node_id": -2
            }
          ]
        }
      ]
    }
  ]
}